# 10장

### 일괄처리

매우 큰 입력 데이터를 받아 데이터를 처리하는 작업을 수행하고, 결과 데이터를 생산함. 대부분의 경우 작업 시간이 오래 걸리기 때문에 사용자가 작업이 끝날 때까지 기다리지 않는다.

임의 접근이 필요한 메모리 양에 따라서 해시 테이블이 나은 선택일지 유닉스 파이프라인이 나은 선택인지에 대한 결과가 달라진다.

어떤 프로그램의 출력을 다른 프로그램의 입력으로 사용하기 위해서는 이 프로그램들이 같은 데이터 형식을 사용해야 한다.즉 서로 호환 가능한 인터페이스를 사용해야 한다.

유닉스에서는 인터페이스가 파일로 (파일 디스크립터) 되어 있기 때문에 파이프로 서로 연결될 수 있다.

### 맵 리듀스와 분산 파일 시스템

맵 리듀스는 유닉스 도구와 비슷하지만, 수천대의 장비로 분산해서 실행이 가능하다는 차이를 갖는다.
유닉스와 마찬가지로 입력을 수정하지 않기 때문에 출력을 생산하는 것 외에 부수 효과는 없다.

유닉스와 다르게 맵리듀스는 파일을 입력과 출력으로 한다.

맵리듀스는 다음과 같은 순서로 작업을 수행한다.

1. 입력파일을 읽어 레코드로 쪼갠다.
2. 입력 레코드마다 매퍼 함수를 호출해 키와 값을 추출한다.
3. 키를 기준으로 키-값 쌍을 모두 정렬한다.
4. 정렬된 키-값 쌍 전체를 대상으로 리듀스 함수를 호출한다.

**매퍼** 는 입력 레코드로부터 키와 값을 추출하는 작업이다.
**리듀서** 는 매퍼가 생산한 키-값쌍을 받아 같은 키를 가진 레코드로 모으고 해당 값의 집합을 반복해 리듀서 함수를 호출해 주는 역할을 한다.

### 맵리듀스 워크플로우

맵리듀스 작업 하나로 해결할 수 있는 문제의 범위는 제한적이다. 따라서 이 작업을 연결해 워크플로로 사용하는 경우가 대부분인데, 이는 맵리듀스 작업 하나의 출력을 다른 맵리듀스 작업의 입력으로 사용하는 것을 말한다.

유닉스 도구와는 다르게 각 명령의 출력을 임시 파일에 쓰고 다음 명령이 그 임시파일로부터 입력을 읽는 방식이다.

맵리듀스는 입력 파일 **전체** 내용을 읽기 때문에 특정 사용자에 대한 데이터를 읽는 것과 같은 작업에서는 색인을 사용하는 것이 더 효과적이다.

→ 처리량을 높이기 위해서는 가능한 한 장비 내에서 연산을 수행하는 것이 좋다.

한 작업의 출력은 다른 특정 작업의 입력으로만 사용되는 경우가 대부분인데, 이런 파일들은 데이터를 옮기는 수단인 **중간 상태** 라고 할 수 있다. 이렇게 중간 상태를 파일로 기록하는 과정을 **구체화** 라고 한다.
이렇게 구체화를 하게 되면 장점은 내결함성을 자연스럽게 얻을 수 있다는 점이다.